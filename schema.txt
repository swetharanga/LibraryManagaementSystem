CREATE DATABASE IF NOT EXISTS Proj1;
USE Proj1;

CREATE TABLE IF NOT EXISTS BOOK (
  isbn   CHARACTER(10) NOT NULL PRIMARY KEY,
  Title  VARCHAR(250) NOT NULL
);

CREATE TABLE IF NOT EXISTS AUTHORS (
    Author_id INT AUTO_INCREMENT PRIMARY KEY,
    Author_name VARCHAR(255) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS BOOK_AUTHORS (
    isbn CHAR(10),
    author_id INT,
    PRIMARY KEY (isbn, author_id),
    FOREIGN KEY (author_id) REFERENCES AUTHORS(author_id),
    FOREIGN KEY (isbn) REFERENCES BOOK(isbn) 
);

CREATE TABLE IF NOT EXISTS BORROWER (
    card_no  CHAR(8) NOT NULL PRIMARY KEY,
    ssn      CHAR(11) NOT NULL,
    fname    VARCHAR(25) NOT NULL,
    lname    VARCHAR(25) NOT NULL,
    address  VARCHAR(100) NOT NULL,  
    phone    CHAR(14)
);

CREATE TABLE IF NOT EXISTS BOOK_LOANS (
    loan_id INT NOT NULL,
    isbn CHAR(10) NOT NULL,
    card_no CHAR(8) NOT NULL,
    date_out DATE NOT NULL,
    due_date DATE NOT NULL,
    date_in DATE,
    PRIMARY KEY (loan_id),
    FOREIGN KEY (isbn) REFERENCES BOOK(isbn),
    FOREIGN KEY (card_no) REFERENCES BORROWER(card_no)
);

CREATE TABLE IF NOT EXISTS FINES (
    loan_id INT NOT NULL,
    fine_amt DECIMAL(10,2) NOT NULL,
    paid INT NOT NULL,
    PRIMARY KEY (loan_id),
    FOREIGN KEY (loan_id) REFERENCES BOOK_LOANS(loan_id)
);
